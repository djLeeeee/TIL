# 0207

어지간해선 평일에 TIL을 안 쓰고 있었는데, 오늘은 참을 수가 없다. 그르르르...

![image](https://user-images.githubusercontent.com/97663863/217017914-0ff6431f-ff7a-4593-9109-62b4484299b1.png)

다이아 문제를 나 혼자만 풀었는데 어케 안 쓰냐고~~

여태 내가 퍼솔한 문제의 유형은

- 이상한 나라 말이여서 아무도 관심이 없던 거
- 방금 막 추가된 문제. 사실상 백준 사이트에 상주 중이라 퍼솔한 느낌

였는데, 4자리 수 번호의 문제를, 그것도 최대 유량 문제를 퍼솔했으니 말 다 했지. 진짜 풀고 신나서 방을 3바퀴 정도 뛰어댕긴 거 같다 ㅋㅋ



## Evacuation - [백준 8301](https://www.acmicpc.net/problem/8301)

> MFMC with Dinic

```Python
n, m = map(int, input().split())
source = 1
sink = n
N = 2 * n
graph = [[] for _ in range(N + 1)]
capacity = [[0] * (N + 1) for _ in range(N + 1)]
ex = 0
for _ in range(m):
    x, y = map(int, input().split())
    if x == source:
        if y == sink:
            ex += 1
        else:
            makeGraph(source, y)
    elif y == sink:
        makeGraph(n + x, sink)
    else:
        makeGraph(x, n + y)
for i in range(2, n):
    makeGraph(i, n + i)
print(ex + dinic(source, sink))
```

문제를 요약하면, **시작부터 도착까지 길이가 3 이하인 경로가 없도록 할 때 끊어야 하는 최소 도로의 갯수**이다.

처음에 생각한 방법은, 길이가 1, 2, 3인 경로들을 모두 구하고, 이 경로들 간의 겹치는 간선이 있으면 경로를 나타내는 노드들 간에 연결을 해줘서 이분 매칭으로 풀면 되겠네! 하고 풀려다가, 생각해보니 완전 그래프 같은 경우에선 너무 많은 경로들이 생겨 최악의 경우 O(n<sup>4</sup>)가 된다는 걸 깨달았다. 그러다가 유량 모델이 머릿속으로 스쳐지나갔다.

일단 시작점 1은 `source`, 도착점 n은 `sink`로 설정해주자. 그 다음 나머지 노드들은 in 노드와 out 노드로 쪼개주자. 당연히 각 노드의 `in` 노드에서 `out` 노드로 용량 1 짜리 간선을 그려주어야 한다. 그 다음 m개의 간선들을,

- `source`에서 `sink`로 바로 가는 간선은 그리지 말자. 이 간선은 모든 상황에서 반드시 지워야하므로, 메모만 해놓자. 아래 경우들에선 이 간선은 제외하고 설명하겠다.
- `source`에서 `idx`로 가는 간선은 `source`에서 `idx in`로 이어주자.
- `idx`에서 `sink`로 가는 간선은 `idx out`에서 `sink`로 이어주자.
- (**중요**) 그 이외의 `idx`에서 `adj`로 가는 간선은 `idx in`에서 `adj out`으로 이어주자.

모든 간선의 비용은 1이다. 이제 최대 유량, 즉 최소 컷을 구하고 거기에 메모한 값을 더해주면 끝! 이제 이 풀이가 정당한 이유를 설명해보자.

- 길이가 1인 경로는 예외 처리해줬다.
- 길이가 2인 경로의 중간 지점을 `idx`라 하자. 이 경우 `source`-`idx in`-`idx out`-`sink`의 경로로 1의 유량이 흐를 수 있다.
- 길이가 3인 경로의 중간 지점을 차례대로 `idx`, `adj`라 하자. 이 경우 `source`-`idx in`-`adj out`-`sink`의 경로로 1의 유량이 흐를 수 있다.
- (**중요**) 길이가 4 이상인 경로에 1인 유량이 흘렀다고 가정하고, 그 경로 상에서 `source` 그리고 `sink`와 이어지지 않은 노드 `idx`와, 경로 상 다음 노드 `adj`를 생각해보자. 그래프를 그릴 때 `idx in`과 `adj out`만을 이어줬으므로, `idx in`이 1의 유량을 받아와야 한다. 하지만 `in` 노드는 `source`로부터만 1의 유량을 받을 수 있게 설정했으므로, `source`와 `idx`가 인접하지 않다는 가정과 모순이다!

그래서 결국 MFMC로 풀어버렸다! 1, 2달 전만해도 '유량 공부해야하는데...' 하던 걸 생각해보면 진짜 큰 발전이다.

일반적이지 않은 모델링의 MFMC 문제이므로, P1 ~ D5 중 뭘 줄지 좀 고민했다. 영어와 프랑스어(D5)보다 모델링 아이디어는 쉬우나(-1), MFMC 개념이 필요하므로(+1) D5를 주기로 결정했다.

음 뭔가 정리를 하고 나니 유량 말고 그리디하게 접근할 수도 있을 거 같은데... 모르겠다. 지금은 그냥 이 기분을 즐기련다. 레이팅 해놨으니 다른 고수 분들이 더 쉬운 풀이 찾아주시것지~
